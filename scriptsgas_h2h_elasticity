
var url = "https://docs.google.com/spreadsheets/d/10yV1sSQYyxh2-p5ByoI0_bPrWqkm1-yXD6afQ4YDJl8/edit#gid=0"



function doGet(){

  var ss = SpreadsheetApp.openByUrl(url);
  var ws = ss.getSheetByName("Extract_elast_data")
  var articleList = ws.getRange(2,1,ws.getRange("A1").getDataRegion().getLastRow()-1,1).getValues();
  var articleListOption = articleList.map(function(r){return '<option>'+r[0]+'</option>';}).join('');

  var tmp = HtmlService.createTemplateFromFile("page");

  tmp.articleListOption = articleListOption;
  return tmp.evaluate();
}


/*
 * Returns member of set with a given mean and standard deviation
 * mean: mean
 * standard deviation: std_dev 
 */
function rnorm(mean, std_dev) {
  return mean + (gaussRandom() * std_dev);
}

/*
 * Returns random number in normal distribution centering on 0.
 * ~95% of numbers returned should fall between -2 and 2
 * ie within two standard deviations
 */
function gaussRandom() {
  var u = 2 * Math.random() - 1;
  var v = 2 * Math.random() - 1;
  var r = u * u + v * v;
  /*if outside interval [0,1] start over*/
  if (r == 0 || r >= 1) return gaussRandom();

  var c = Math.sqrt(-2 * Math.log(r) / r);
  return u * c;
}

function blahblah() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheets()[0];

  var a_mean = sheet.getRange("meanA").getValue();
  var a_sd = sheet.getRange("sdA").getValue();
  var b_mean = sheet.getRange("meanB").getValue();
  var b_sd = sheet.getRange("sdB").getValue();

  ll = []; for (var i = 0; i < 10000; i++) ll.push([rnorm(a_mean, a_sd)]);

  var range = sheet.getRange("a2:a10001");
  range.setValues(ll);

  ll = []; for (var i = 0; i < 10000; i++) ll.push([rnorm(b_mean, b_sd)]);

  var range = sheet.getRange("b2:b10001");
  range.setValues(ll);

}

function getMeanSD(){
  var article = document.getElementById('article_a').value;
  document.getElementById('article_a_mean').value = 1;
}

